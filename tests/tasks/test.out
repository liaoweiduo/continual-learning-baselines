wandb: Tracking run with wandb version 0.13.4
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
/opt/conda/lib/python3.7/site-packages/avalanche/training/plugins/evaluation.py:82: UserWarning: No benchmark provided to the evaluation plugin. Metrics may be computed on inconsistent portion of streams, use at your own risk.
  "No benchmark provided to the evaluation plugin. "
/opt/conda/lib/python3.7/site-packages/avalanche/training/plugins/early_stopping.py:113: UserWarning: Metric Top1_Acc_Stream used by the EarlyStopping plugin is not computed yet. EarlyStopping will not be triggered.
  f"Metric {self.metric_name} used by the EarlyStopping plugin "
/opt/conda/lib/python3.7/site-packages/avalanche/evaluation/metric_utils.py:67: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Add python path: /liaoweiduo/continual-learning-baselines
Add python path: /liaoweiduo/continual-learning-baselines
{'dataset': 'cgqa', 'dataset_mode': 'continual', 'return_task_id': True, 'model_backbone': 'resnet18', 'model_pretrained': False, 'cuda': 0, 'train_mb_size': 100, 'epochs': 100, 'learning_rate': 0.03, 'n_experiences': 10, 'seed': 1234, 'train_class_order': 'shuffle', 'device': 0, 'strategy': 'er', 'er_mem_size': 1000, 'lwf_alpha': 1, 'lwf_temperature': 2, 'gem_patterns_per_exp': 256, 'gem_mem_strength': 0.5, 'ewc_lambda': 1, 'ewc_mode': 'separate', 'ewc_decay': 0.0, 'eval_mb_size': 50, 'eval_every': 1, 'eval_patience': 5, 'test_n_experiences': 300, 'test_n_way': 10, 'test_n_shot': 10, 'test_n_val': 5, 'test_n_query': 10, 'test_freeze_feature_extractor': False, 'pretrained_model_path': '../pretrained/pretrained_resnet.pt.tar', 'dataset_root': '../datasets', 'exp_root': '../avalanche-experiments', 'use_wandb': True, 'project_name': 'CGQA', 'exp_name': 'er-tsk-lr0_03', 'use_interactive_logger': False, 'f': ''}
Create experiment with path: /liaoweiduo/avalanche-experiments/CGQA/er-tsk-lr0_03
Starting experiment...
Start of experience  0
Current Classes:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Current Classes:  [('fence', 'flower'), ('door', 'grass'), ('leaves', 'shirt'), ('grass', 'table'), ('shoe', 'shorts'), ('hat', 'table'), ('leaves', 'wall'), ('chair', 'grass'), ('door', 'shoe'), ('fence', 'helmet')]
Training completed
Computing accuracy on the whole test set.
Start of experience  1
Current Classes:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Current Classes:  [('chair', 'sign'), ('grass', 'shorts'), ('hat', 'plate'), ('pole', 'shirt'), ('grass', 'pants'), ('pants', 'shoe'), ('pole', 'wall'), ('bench', 'chair'), ('helmet', 'plate'), ('leaves', 'shoe')]
Training completed
Computing accuracy on the whole test set.
Start of experience  2
Current Classes:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Current Classes:  [('bench', 'shorts'), ('flower', 'pole'), ('chair', 'helmet'), ('pants', 'shorts'), ('helmet', 'shorts'), ('helmet', 'shoe'), ('hat', 'jacket'), ('hat', 'shorts'), ('jacket', 'shoe'), ('fence', 'wall')]
Training completed
Computing accuracy on the whole test set.
Start of experience  3
Current Classes:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Current Classes:  [('bench', 'helmet'), ('hat', 'shirt'), ('bench', 'sign'), ('plate', 'wall'), ('grass', 'plate'), ('helmet', 'pole'), ('door', 'leaves'), ('bench', 'pants'), ('grass', 'jacket'), ('jacket', 'pole')]
wandb: Waiting for W&B process to finish... (failed 255).
wandb: 
wandb: Run history:
wandb: ExperienceForgetting/eval_phase/test_stream/Task000/Exp000 ▁█
wandb: ExperienceForgetting/eval_phase/test_stream/Task001/Exp001 ▁
wandb:                Loss_Epoch/train_phase/train_stream/Task000 █▇▆▆▆▆▆▆▆▅▅▅▅▄▄▄▃▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:                Loss_Epoch/train_phase/train_stream/Task001 █▆▅▄▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁
wandb:                Loss_Epoch/train_phase/train_stream/Task002 █▅▄▃▃▂▂▂▁▂▁▁▁▁▁▁▁▁
wandb:                Loss_Epoch/train_phase/train_stream/Task003 █▅▄▃▃▂▂▂▂▁▁
wandb:             Loss_Exp/eval_phase/test_stream/Task000/Exp000 ▁▇█
wandb:             Loss_Exp/eval_phase/test_stream/Task001/Exp001 █▁▆
wandb:             Loss_Exp/eval_phase/test_stream/Task002/Exp002 ██▁
wandb:             Loss_Exp/eval_phase/test_stream/Task003/Exp003 ▁▁▁
wandb:             Loss_Exp/eval_phase/test_stream/Task004/Exp004 ▁▁▁
wandb:             Loss_Exp/eval_phase/test_stream/Task005/Exp005 ▁▁▁
wandb:             Loss_Exp/eval_phase/test_stream/Task006/Exp006 ▁▁▁
wandb:             Loss_Exp/eval_phase/test_stream/Task007/Exp007 ▁▁▁
wandb:             Loss_Exp/eval_phase/test_stream/Task008/Exp008 ▁▁▁
wandb:             Loss_Exp/eval_phase/test_stream/Task009/Exp009 ▁▁▁
wandb:              Loss_Exp/eval_phase/val_stream/Task000/Exp000 ▃▃▃▃▃▃▂▂█▃▃▂▃▂▂▂▁▇▂▂▁▁▁▁▂▂▁▁▂▂▁▂▂▂▂▂▂▂▃
wandb:              Loss_Exp/eval_phase/val_stream/Task001/Exp001 █▁▁▁▁▂▃▃▇▂▄▄▆▄▄▃▄▄▆█▆▆
wandb:              Loss_Exp/eval_phase/val_stream/Task002/Exp002 █▁▁▁▃▃▃▂▆▃▂▂▃▂▄▅▄▃▆
wandb:              Loss_Exp/eval_phase/val_stream/Task003/Exp003 █▁▁▂▁▂▂▁▂▂▂▂
wandb:                 Loss_Stream/eval_phase/test_stream/Task000 ▁▇█
wandb:                 Loss_Stream/eval_phase/test_stream/Task001 █▁▆
wandb:                 Loss_Stream/eval_phase/test_stream/Task002 ██▁
wandb:                 Loss_Stream/eval_phase/test_stream/Task003 ▁▁▁
wandb:                 Loss_Stream/eval_phase/test_stream/Task004 ▁▁▁
wandb:                 Loss_Stream/eval_phase/test_stream/Task005 ▁▁▁
wandb:                 Loss_Stream/eval_phase/test_stream/Task006 ▁▁▁
wandb:                 Loss_Stream/eval_phase/test_stream/Task007 ▁▁▁
wandb:                 Loss_Stream/eval_phase/test_stream/Task008 ▁▁▁
wandb:                 Loss_Stream/eval_phase/test_stream/Task009 ▁▁▁
wandb:                  Loss_Stream/eval_phase/val_stream/Task000 ▃▃▃▃▃▃▂▂█▃▃▂▃▂▂▂▁▇▂▂▁▁▁▁▂▂▁▁▂▂▁▂▂▂▂▂▂▂▃
wandb:                  Loss_Stream/eval_phase/val_stream/Task001 █▁▁▁▁▂▃▃▇▂▄▄▆▄▄▃▄▄▆█▆▆
wandb:                  Loss_Stream/eval_phase/val_stream/Task002 █▁▁▁▃▃▃▂▆▃▂▂▃▂▄▅▄▃▆
wandb:                  Loss_Stream/eval_phase/val_stream/Task003 █▁▁▂▁▂▂▁▂▂▂▂
wandb:                    StreamForgetting/eval_phase/test_stream █▆▁
wandb:                     StreamForgetting/eval_phase/val_stream ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            Top1_Acc_Epoch/train_phase/train_stream/Task000 ▁▁▂▂▂▂▂▃▃▃▃▄▄▄▅▅▅▆▆▆▆▆▇▇▇▇▇▇██████████
wandb:            Top1_Acc_Epoch/train_phase/train_stream/Task001 ▁▃▄▅▆▆▇▇▇▇███████████
wandb:            Top1_Acc_Epoch/train_phase/train_stream/Task002 ▁▄▅▆▆▇▇▇█▇████████
wandb:            Top1_Acc_Epoch/train_phase/train_stream/Task003 ▁▄▅▆▇▇▇▇▇██
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task000/Exp000 ▆█▁
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task001/Exp001 ▁▇█
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task002/Exp002 ▁▁█
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task003/Exp003 ▁▁▁
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task004/Exp004 ▁▁▁
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task005/Exp005 ▁▁▁
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task006/Exp006 ▁▁▁
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task007/Exp007 ▁▁▁
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task008/Exp008 ▁▁▁
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task009/Exp009 ▁▁▁
wandb:          Top1_Acc_Exp/eval_phase/val_stream/Task000/Exp000 ▁▁▁▂▁▂▃▃▁▃▃▄▃▅▅▆▇▃▅▇▇██▇▆▇▇█████▇█████▇
wandb:          Top1_Acc_Exp/eval_phase/val_stream/Task001/Exp001 ▁▇▇▇▇▇▇█▆█▇█▇▇████▇▇▇█
wandb:          Top1_Acc_Exp/eval_phase/val_stream/Task002/Exp002 ▁▇▇█▇▇▇█▆█████▇▇██▇
wandb:          Top1_Acc_Exp/eval_phase/val_stream/Task003/Exp003 ▁███████████
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task000 ▆█▁
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task001 ▁▇█
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task002 ▁▁█
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task003 ▁▁▁
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task004 ▁▁▁
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task005 ▁▁▁
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task006 ▁▁▁
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task007 ▁▁▁
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task008 ▁▁▁
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task009 ▁▁▁
wandb:              Top1_Acc_Stream/eval_phase/val_stream/Task000 ▁▁▁▂▁▂▃▃▁▃▃▄▃▅▅▆▇▃▅▇▇██▇▆▇▇█████▇█████▇
wandb:              Top1_Acc_Stream/eval_phase/val_stream/Task001 ▁▇▇▇▇▇▇█▆█▇█▇▇████▇▇▇█
wandb:              Top1_Acc_Stream/eval_phase/val_stream/Task002 ▁▇▇█▇▇▇█▆█████▇▇██▇
wandb:              Top1_Acc_Stream/eval_phase/val_stream/Task003 ▁███████████
wandb:                                         TrainingExperience ▁▅█
wandb: 
wandb: Run summary:
wandb: ExperienceForgetting/eval_phase/test_stream/Task000/Exp000 0.009
wandb: ExperienceForgetting/eval_phase/test_stream/Task001/Exp001 -0.049
wandb:                Loss_Epoch/train_phase/train_stream/Task000 0.11472
wandb:                Loss_Epoch/train_phase/train_stream/Task001 0.03066
wandb:                Loss_Epoch/train_phase/train_stream/Task002 0.04171
wandb:                Loss_Epoch/train_phase/train_stream/Task003 0.03177
wandb:             Loss_Exp/eval_phase/test_stream/Task000/Exp000 3.08468
wandb:             Loss_Exp/eval_phase/test_stream/Task001/Exp001 2.12711
wandb:             Loss_Exp/eval_phase/test_stream/Task002/Exp002 1.19859
wandb:             Loss_Exp/eval_phase/test_stream/Task003/Exp003 2.30258
wandb:             Loss_Exp/eval_phase/test_stream/Task004/Exp004 2.30258
wandb:             Loss_Exp/eval_phase/test_stream/Task005/Exp005 2.30258
wandb:             Loss_Exp/eval_phase/test_stream/Task006/Exp006 2.30258
wandb:             Loss_Exp/eval_phase/test_stream/Task007/Exp007 2.30258
wandb:             Loss_Exp/eval_phase/test_stream/Task008/Exp008 2.30258
wandb:             Loss_Exp/eval_phase/test_stream/Task009/Exp009 2.30258
wandb:              Loss_Exp/eval_phase/val_stream/Task000/Exp000 2.47358
wandb:              Loss_Exp/eval_phase/val_stream/Task001/Exp001 1.92683
wandb:              Loss_Exp/eval_phase/val_stream/Task002/Exp002 1.81635
wandb:              Loss_Exp/eval_phase/val_stream/Task003/Exp003 0.86929
wandb:                 Loss_Stream/eval_phase/test_stream/Task000 3.08468
wandb:                 Loss_Stream/eval_phase/test_stream/Task001 2.12711
wandb:                 Loss_Stream/eval_phase/test_stream/Task002 1.19859
wandb:                 Loss_Stream/eval_phase/test_stream/Task003 2.30258
wandb:                 Loss_Stream/eval_phase/test_stream/Task004 2.30258
wandb:                 Loss_Stream/eval_phase/test_stream/Task005 2.30258
wandb:                 Loss_Stream/eval_phase/test_stream/Task006 2.30258
wandb:                 Loss_Stream/eval_phase/test_stream/Task007 2.30258
wandb:                 Loss_Stream/eval_phase/test_stream/Task008 2.30258
wandb:                 Loss_Stream/eval_phase/test_stream/Task009 2.30258
wandb:                  Loss_Stream/eval_phase/val_stream/Task000 2.47358
wandb:                  Loss_Stream/eval_phase/val_stream/Task001 1.92683
wandb:                  Loss_Stream/eval_phase/val_stream/Task002 1.81635
wandb:                  Loss_Stream/eval_phase/val_stream/Task003 0.86929
wandb:                    StreamForgetting/eval_phase/test_stream -0.02
wandb:                     StreamForgetting/eval_phase/val_stream 0.0
wandb:            Top1_Acc_Epoch/train_phase/train_stream/Task000 0.9632
wandb:            Top1_Acc_Epoch/train_phase/train_stream/Task001 0.9901
wandb:            Top1_Acc_Epoch/train_phase/train_stream/Task002 0.98555
wandb:            Top1_Acc_Epoch/train_phase/train_stream/Task003 0.989
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task000/Exp000 0.642
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task001/Exp001 0.724
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task002/Exp002 0.763
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task003/Exp003 0.1
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task004/Exp004 0.1
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task005/Exp005 0.1
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task006/Exp006 0.1
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task007/Exp007 0.1
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task008/Exp008 0.1
wandb:         Top1_Acc_Exp/eval_phase/test_stream/Task009/Exp009 0.1
wandb:          Top1_Acc_Exp/eval_phase/val_stream/Task000/Exp000 0.618
wandb:          Top1_Acc_Exp/eval_phase/val_stream/Task001/Exp001 0.708
wandb:          Top1_Acc_Exp/eval_phase/val_stream/Task002/Exp002 0.672
wandb:          Top1_Acc_Exp/eval_phase/val_stream/Task003/Exp003 0.796
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task000 0.642
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task001 0.724
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task002 0.763
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task003 0.1
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task004 0.1
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task005 0.1
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task006 0.1
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task007 0.1
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task008 0.1
wandb:             Top1_Acc_Stream/eval_phase/test_stream/Task009 0.1
wandb:              Top1_Acc_Stream/eval_phase/val_stream/Task000 0.618
wandb:              Top1_Acc_Stream/eval_phase/val_stream/Task001 0.708
wandb:              Top1_Acc_Stream/eval_phase/val_stream/Task002 0.672
wandb:              Top1_Acc_Stream/eval_phase/val_stream/Task003 0.796
wandb:                                         TrainingExperience 2
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /liaoweiduo/avalanche-experiments/CGQA/er-tsk-lr0_03/wandb/offline-run-20230215_043414-25q0jcnc
wandb: Find logs at: /liaoweiduo/avalanche-experiments/CGQA/er-tsk-lr0_03/wandb/offline-run-20230215_043414-25q0jcnc/logs
Traceback (most recent call last):
  File "experiments/continual_training.py", line 257, in <module>
    results = continual_train()
  File "experiments/continual_training.py", line 125, in continual_train
    cl_strategy.train(experience, eval_streams=[val_task])
  File "/opt/conda/lib/python3.7/site-packages/avalanche/training/templates/base_sgd.py", line 130, in train
    super().train(experiences, eval_streams, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/avalanche/training/templates/base.py", line 107, in train
    self._train_exp(self.experience, eval_streams, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/avalanche/training/templates/base_sgd.py", line 178, in _train_exp
    self.training_epoch(**kwargs)
  File "/opt/conda/lib/python3.7/site-packages/avalanche/training/templates/base_sgd.py", line 243, in training_epoch
    self.backward()
  File "/opt/conda/lib/python3.7/site-packages/avalanche/training/templates/base_sgd.py", line 255, in backward
    self.loss.backward()
  File "/opt/conda/lib/python3.7/site-packages/torch/_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.7/site-packages/torch/autograd/__init__.py", line 149, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
